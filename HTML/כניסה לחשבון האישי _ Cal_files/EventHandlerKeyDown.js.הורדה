
// Handle the enter key for a section of a form, binding it to the provided submit buton 
function HandleEnterKey(event) { 

    var nav = window.Event ? true : false; 
    if (nav) { 
        return NetscapeEventHandler_KeyDown(event); 
    } else { 
        return MicrosoftEventHandler_KeyDown(); 
    } 
    
} 

function addEventListener_onload()
{
    if(document.addEventListener){ 
        document.addEventListener("keypress", HandleEnterKey, true); 
    } 
    else{ 
          document.attachEvent("onkeypress", HandleEnterKey); 
        } 
}

function NetscapeEventHandler_KeyDown(e) { 
    if (e.which == 13 && e.target.type != 'textarea' && e.target.type != 'submit' && e.target.type != 'image') { 
    e.returnValue = false; 
    e.cancel = true; 
    e.preventDefault(); 
    var att = e.target.attributes['SubmitControl']; 
    if(att!=null) 
    CallSubmit(att.value) 
    return false; 
    } 
    return true; 
} 

function MicrosoftEventHandler_KeyDown() { 

	if (event.keyCode == 13 && 
	    event.srcElement.type != 'textarea' && 
		event.srcElement.type != 'submit' && 
		event.srcElement.type != 'image') 
	{ 
		event.returnValue = false; 
	} 
}

