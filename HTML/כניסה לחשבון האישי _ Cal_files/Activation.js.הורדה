function goToLogin(p_url)
{        
    //navigate with referer for IE
    var fakeLink = document.createElement("a");
    
    if (typeof(fakeLink.click) == "undefined")
        location.href = p_url;  //FF
    else
    {
        //IE        
        fakeLink.href = p_url;
        document.body.appendChild(fakeLink);
        fakeLink.click();
    }
}

var _errorMessages;
function changeErrorArrow(ctrl, args)
{
    var Ids = "";
    _errorMessages = "";
    
    for (i=0; i<Page_Validators.length; i++) 
    {             
        var _activationVld = Page_Validators[i];
        var ctrlToVld = _activationVld.controltovalidate;                          
        if (typeof(ctrlToVld) != "undefined")
        {                            
            if (Ids.indexOf(ctrlToVld) == -1)
            {                                                                
                var arrowCtrl = bubbleForElement(document.getElementById(ctrlToVld), "tr").cells[0].getElementsByTagName("DIV")[0];
                
                if (!_activationVld.isvalid)
                {                            
                    chkDuplicateErrMsg(_activationVld);                                        
                    //arrowCtrl.className = "redArrow";                         
                    Ids += ctrlToVld;
                }            
                //else if (_activationVld.isvalid && arrowCtrl.className == "redArrow")                
                  //  arrowCtrl.className = "blueArrow";                     
            }
                                       
        } 
        else
        {               
            try            
            {                      
                var __tr = bubbleForElement(_activationVld, "tr");
                var arrowCtrl = bubbleForElement(__tr, "tr").cells[0].getElementsByTagName("DIV")[0];                                
                                                
                if (_activationVld.id.indexOf("Date") > -1)
                {                           
                    /*if (!_activationVld.isvalid)                
                    {                        
                        arrowCtrl.className = "redArrow";                                         
                    }
                    else if (_activationVld.isvalid && arrowCtrl.className == "redArrow")
                        arrowCtrl.className = "blueArrow";   */
                        
                    chkDuplicateErrMsg(_activationVld);
                }  
            }
            catch(e) { }
        }   
    }                    
}

function chkDuplicateErrMsg(p_vld)
{           
    if (p_vld.errormessage != undefined && _errorMessages.indexOf(p_vld.errormessage) > -1)
        p_vld.isvalid = true;                    
    else
        if (!p_vld.isvalid)
            _errorMessages += p_vld.errormessage;   
}

function RemoveDuplicateMsgs()
{    
    _errorMessages = "";
    for (i=0; i<Page_Validators.length; i++) 
    {
        chkDuplicateErrMsg(Page_Validators[i]);     
    }
}

var _cvvCnt = 0;
//enabled only validators that belong to checked cards
function handleVld(ctrl)
{
    var txt = $(ctrl).closest("tbody").find(".input input");
    
    if (ctrl.checked)
    {
        /*if (txt.val().length == 0)
        {
            //txt.val(" ");
            //txt.select();
        }
        _cvvCnt++;*/
    }
    else if(txt.val().length > 0)
        _cvvCnt--;
}

function ChkCvvCnt(p_sender, p_args)
{               
    RemoveDuplicateMsgs();   
    p_args.IsValid = _cvvCnt > 0;
}

function enableCardChk(p_ctrl)
{    
    //get checkbox ctrl
    var _chkCtrl = bubbleForElement(p_ctrl, "TBODY").rows[0].cells[0].getElementsByTagName("INPUT")[0];    
    
    if (p_ctrl.value.length >= 0)
    {        
        if (_chkCtrl.checked == false)
        {
            _chkCtrl.checked = true;
            _cvvCnt++;
        }
        else if (p_ctrl.value.length == 0)
        {
            _cvvCnt++;
        }        
    }
    else
    {
        if (_chkCtrl.checked)
        {
            _chkCtrl.checked = false;
            _cvvCnt--;
        }
    }
}

function chkForEmptyTxt(p_ctrl)
{    
    //get checkbox ctrl
    var _chkCtrl = bubbleForElement(p_ctrl, "TBODY").rows[0].cells[0].getElementsByTagName("INPUT")[0];    
    
    if (p_ctrl.value.length == 0)
    {
        _chkCtrl.checked = false;
        _cvvCnt--;
    }
}

var _msgErr;
function clearMsgErr()
{    
    var ctrl = document.getElementById(_msgErr);
    
    if (ctrl != null)
        document.getElementById(_msgErr).style.display = "none";
}

